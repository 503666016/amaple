<module :title="启动路由 · Amaple">
	<template>
		<div><h1 id="启动路由"><a href="#启动路由" class="headerlink" title="启动路由"></a>启动路由</h1><p>开始编写具体的代码前，首先需启动单页模式并进行简单配置。在<code>src/index.html</code>中引入amaple.js框架文件后我们就可以使用<code>am</code>这个全局对象。我们在开发包的<code>src/config.js</code>文件中调用<code>am.startRouter</code>函数并传入一个Object对象进行启动路由并配置单页应用。首先我们来配置url风格：<br><figure class="highlight javascript"><figcaption><span>javascript</span></figcaption><table><tr><td class="code"><pre><span class="line">am.startRouter ( &#123;</span><br><span class="line"></span><br><span class="line">     <span class="comment">// amaplejs中存在两种url模式，分别为</span></span><br><span class="line">     <span class="comment">// url中带“#”的hash模式，所有浏览器都支持此模式。可使用history: am.HASH指定</span></span><br><span class="line">     <span class="comment">// url中不带“#”的restful模式，此模式使用html5 history API实现，与普通url相同，</span></span><br><span class="line">     <span class="comment">// 但在不支持此特性的浏览器中不能正常使用，且需后台服务端的配置支持，可使用history: am.BROWSER指定</span></span><br><span class="line">     <span class="comment">// 以上为两种可选的url模式,你也可以指定history : am.AUTO来让框架自动选择模式，在支持html5 history API的浏览器下自动使用此模式，</span></span><br><span class="line">     <span class="comment">// 不支持的情况下将自动回退使用hash模式</span></span><br><span class="line">     history : am.HASH</span><br><span class="line">&#125; );</span><br></pre></td></tr></table></figure></p>
<h2 id="配置一个简单的匹配路由"><a href="#配置一个简单的匹配路由" class="headerlink" title="配置一个简单的匹配路由"></a>配置一个简单的匹配路由</h2><p>正如我们所知到的，不同url将会显示不同的页面，在这里我们也需告诉框架一个url应该显示哪几个模块，其实这也是很简单的，具体分为两步：</p>
<ul>
<li><p>[1].在入口html文件（即<code>src/index.html</code>文件）内定义一个模块节点，来告诉框架请求的模块内容放到页面的哪个位置</p>
<figure class="highlight html"><figcaption><span>html</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">     <span class="comment">&lt;!-- 在&lt;body&gt;内添加一个&lt;div&gt;并给它添加:module属性，这样就指定了一个不具名的模块节点 --&gt;</span></span><br><span class="line">     <span class="comment">&lt;!-- 你可以将模块节点理解为模块渲染输出的容器，:module属性为空值表示不具名的模块节点，且任何标签都可以作为模块节点 --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">div</span> <span class="attr">:module</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>[2].在<code>am.startRouter</code>函数中为模块设置相关参数，在函数参数内分别添加<code>baseURL</code>、<code>module</code>和<code>routes</code>参数，如下：</p>
<figure class="highlight javascript"><figcaption><span>javascript</span></figcaption><table><tr><td class="code"><pre><span class="line">am.startRouter( &#123;</span><br><span class="line">    baseURL : &#123;</span><br><span class="line">          <span class="comment">// 为模块文件设置base路径，所有的模块文件请求路径都将基于“/module”目录，不设置时默认“/”</span></span><br><span class="line">          <span class="built_in">module</span>: <span class="string">"/module"</span></span><br><span class="line">     &#125;,</span><br><span class="line"></span><br><span class="line">     <span class="comment">// 模块文件后缀，其实默认的模块文件后缀就是“.html”，你也可以为它设置其他后缀</span></span><br><span class="line">     <span class="built_in">module</span> : &#123;</span><br><span class="line">          suffix: <span class="string">".html"</span></span><br><span class="line">     &#125;,</span><br><span class="line"></span><br><span class="line">     <span class="comment">// routes定义的function接收一个Router类的对象，使用此对象我们就可以告诉框架一个url应该显示哪几个模块</span></span><br><span class="line">     routes : <span class="function"><span class="keyword">function</span> (<span class="params"> router </span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">          router.module ().route ( <span class="string">"/"</span>, <span class="string">"index"</span> ).route ( <span class="string">"/about"</span>, <span class="string">"about"</span> );</span><br><span class="line">          <span class="comment">// 在module和route函数内都会返回router对象本身，所以可使用链式调用</span></span><br><span class="line">          <span class="comment">// router.module函数选定配置的模块节点，函数内没有传入任何参数表示选定一个不具名的模块节点，</span></span><br><span class="line">          <span class="comment">// 我们在&lt;body&gt;内已定义了一个不具名的模块节点</span></span><br><span class="line">          </span><br><span class="line">          <span class="comment">// 你也可以为模块指定名称，像这样&lt;div :module="main"&gt;&lt;/div&gt;，</span></span><br><span class="line">          <span class="comment">// 此时需这样调用router.module ( "main" )来选定模块节点。</span></span><br><span class="line">          </span><br><span class="line">          <span class="comment">// router.route函数为选定模块配置匹配路径与模块的映射，</span></span><br><span class="line">          <span class="comment">// 当url相对路径为“/”时将加载index.html模块文件，当url相对路径为“/about”时将加载about.html模块文件</span></span><br><span class="line">     &#125;,</span><br><span class="line"></span><br><span class="line">     <span class="comment">// 已讲解过的配置</span></span><br><span class="line">     history : am.HASH</span><br><span class="line">&#125; );</span><br></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p>简单的配置后，接下来就可以来编写这个<code>index.html</code>模块文件了，在<code>src/module</code>文件夹内添加一个<code>index.html</code>文件。</p>
</blockquote>
</div>
		<div id="page-nav">
			<a class="title-color nav next" href="{{ next.path }}" :if="next.title">
				<img src="/images/arrow.png">
				<span class="title-color">{{ next.title }}</span>
			</a>
			<a class="nav prev" href="{{ prev.path }}" :if="prev.title">
				<span class="title-color">{{ prev.title }}</span>
				<img src="/images/arrow.png">
			</a>
		</div>
	</template>
	<script>
		function scrollAnchor ( anchor, scrollTo ) {
			var anchorElem = document.querySelector ( "#" + window.decodeURI ( anchor ) );
			if ( anchorElem ) {
				scrollTo ( anchorElem.offsetTop - 10 );
			}
		}

		new am.Module ( {
			init: function ( menu, checkPost ) {
				var list = [{"tag":"启动路由","children":[{"tag":"配置一个简单的匹配路由","children":[]}]}],
					posts = [{"title":"开始","path":"first-step","index":1},{"title":"启动路由","path":"start-router","index":2,"current":true},{"title":"模块","path":"module","index":3},{"title":"模板指令与状态数据(state)","path":"directive-and-state","index":4},{"title":"组件","path":"component","index":5},{"title":"插件","path":"plugin","index":6},{"title":"路由配置","path":"config-router","index":7}];

				menu.state.list = list.length > 0 ? list : [ { children: [] } ];
				menu.state.posts = posts;
				menu.state.categoryName = "基础";

				return {
					prev: checkPost ( {
						title: "模块",
						path: "module"
					}, posts ),
					next: checkPost ( {
						title: "开始",
						path: "first-step"
					}, posts )
				};
			},
			mounted: function ( scrollTo ) {
				scrollAnchor ( this.get.target, scrollTo );
			},
			queryUpdated: function ( scrollTo ) {
				scrollAnchor ( this.get.target, scrollTo );
			}
		} );
	</script>

	<style scoped>
		#page-nav {
			margin-top: 60px;
		}
		.nav {
			font-size: 16px;
			border: none;
		}
		.nav:hover {
			border: none;
		}
		.nav img {
			width: 18px;
			margin: 0 5px;
			vertical-align: middle;
		}
		.prev {
			float: right;
		}
		.next {
			float: left;
		}
		.next img {
			transform: rotate(180deg);
			-ms-transform: rotate(180deg);
			-moz-transform: rotate(180deg);
			-webkit-transform: rotate(180deg);;
			-o-transform: rotate(180deg);
		}
	</style>
</module>