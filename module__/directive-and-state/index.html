<module :title="模板指令与状态数据(state) · Amaple">
	<template>
		<div><h1 id="模板指令与状态数据-state"><a href="#模板指令与状态数据-state" class="headerlink" title="模板指令与状态数据(state)"></a>模板指令与状态数据(state)</h1><p>一个模块的template模板、JavaScript和css之间的关系其实可以如下图表示：<br><img src="/module__/directive-and-state/module_connection.jpg"></p>
<p>如果你了解Angular、Vue动态模板，那你将会对Amaple的模板感到很熟悉，在Amaple中，template模板也是基于模板指令和状态数据的动态模板引擎，当一个状态数据改变时，在template模板中与它绑定的dom元素将自动作出相应的更新，所以此时你只需关心模块内的状态数据，而不需去理会视图层的更新。</p>
<h2 id="指令类型"><a href="#指令类型" class="headerlink" title="指令类型"></a>指令类型</h2><p>指令分为动态指令和静态指令，动态指令的值会被当作JavaScript代码被解析，所以它们可以获取并绑定状态属性的值，如<code>:if</code>、<code>:for</code>等指令；而静态属性的值只会被当做普通的字符串处理，无法绑定状态属性，如<code>:module</code>和<code>:ref</code>指令。</p>
<h2 id="使用插值表达式输出文本"><a href="#使用插值表达式输出文本" class="headerlink" title="使用插值表达式输出文本"></a>使用插值表达式输出文本</h2><p>我们直接先看看在<code>index.html</code>模板中使用插值表达式输出文本和属性，你应该会很快明白是怎么回事了：<br><figure class="highlight html"><figcaption><span>html</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">module</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 插值表达式由"&#123;&#123;&#125;&#125;"来表示 --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 插值表达式可在dom元素内和元素属性上进行状态数据的绑定 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; text &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 插值表达式也可以多个插值表达式同时使用，或与固定字符串混合使用 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; link &#125;&#125;?&#123;&#123; search &#125;&#125;"</span>&gt;</span>direct to page about<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="comment">// init函数将返回状态属性对象用于解析挂载模板数据</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">new</span> am.Module ( &#123;</span></span><br><span class="line"><span class="javascript">            init : <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="javascript">                    text : <span class="string">"hello amaplejs,page index"</span>,</span></span><br><span class="line"><span class="javascript">                    link : <span class="string">"/about"</span>,</span></span><br><span class="line"><span class="javascript">                    search : <span class="string">"from=index"</span></span></span><br><span class="line"><span class="undefined">                &#125;;</span></span><br><span class="line"><span class="undefined">            &#125;,</span></span><br><span class="line"><span class="javascript">            mounted : <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="undefined">                </span></span><br><span class="line"><span class="javascript">                <span class="comment">// 通过this.state获取所有的状态属性</span></span></span><br><span class="line"><span class="javascript">                <span class="keyword">this</span>.state.text = <span class="string">"text has changed"</span>;</span></span><br><span class="line"><span class="javascript">                <span class="comment">// this.state.text被赋值后模板中“hello amaplejs,page index”也将自动更新为“text has changed”</span></span></span><br><span class="line"><span class="javascript">                <span class="comment">// 在queryUpdated、paramUpdated和unmount周期函数中也可以通过此方法来获取或赋值状态属性的值</span></span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125; );</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">        span &#123; font-size: 20px; &#125;</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>①. <code>&lt;template&gt;</code>模板中的取值范围为当前模块的状态数据对象，在上面示例中，解析挂载时<code>{ { text } }</code>被替换为状态数据的<code>text</code>属性值；<br>②. 插值表达式的<code>{ { ... } }</code>将被作为JavaScript代码解析，如你可以这样写<code>{ { text === 1 ? &quot;show&quot; : &quot;hidden&quot; } }</code>，表示<code>text</code>属性值等于数字<code>1</code>时输出<code>&quot;show&quot;</code>，否则输出<code>&quot;hidden&quot;</code>。</p>
</blockquote>
<h3 id="插值表达式在style与class属性的特殊表现"><a href="#插值表达式在style与class属性的特殊表现" class="headerlink" title="# 插值表达式在style与class属性的特殊表现"></a># 插值表达式在style与class属性的特殊表现</h3><p>插值表达式一般输出字符串（状态属性值不为字符串时将会调用该值的<code>toString</code>函数），但在<code>style</code>属性上使用插值表达式时会将一个object对象转换为内联样式的格式，在<code>class</code>属性上使用时会将一个<code>array</code>数组转换为以空格隔开的字符串：<br><figure class="highlight html"><figcaption><span>html</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"&#123;&#123; clsList &#125;&#125;"</span> <span class="attr">style</span>=<span class="string">"&#123;&#123; styleObj &#125;&#125;"</span>&gt;</span><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">new</span> am.Module ( &#123;</span></span><br><span class="line"><span class="javascript">        init : <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="undefined">                </span></span><br><span class="line"><span class="javascript">                <span class="comment">// 在class属性使用插值表达式输出时自动转换为"cls1 cls2"</span></span></span><br><span class="line"><span class="javascript">                clsList: [ <span class="string">"cls1"</span>, <span class="string">"cls2"</span> ],</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">                <span class="comment">// 在style属性使用插值表达式输出时自动转换为"background:red;font-size:20px"</span></span></span><br><span class="line"><span class="javascript">                <span class="comment">// 注意两点：</span></span></span><br><span class="line"><span class="javascript">                <span class="comment">// ①.使用驼峰式来定义css属性名，如fontSize，在输出时将自动转换为font-size</span></span></span><br><span class="line"><span class="javascript">                <span class="comment">// ②.为css属性名赋值为一个量值时可直接写为数字，如fontSize: 20，它将自动补充“px”单位</span></span></span><br><span class="line"><span class="undefined">                styleObj: &#123;</span></span><br><span class="line"><span class="javascript">                    background: <span class="string">"red"</span>,</span></span><br><span class="line"><span class="undefined">                    fontSize: 20</span></span><br><span class="line"><span class="undefined">                &#125;</span></span><br><span class="line"><span class="undefined">            &#125;;</span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="undefined">    &#125; );</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h2 id="循环渲染输出dom元素"><a href="#循环渲染输出dom元素" class="headerlink" title="循环渲染输出dom元素"></a>循环渲染输出dom元素</h2><p>在实际项目中，经常会遇到根据数据库的数据来渲染一个列表的需求，如用户列表、使用表格展示数据等，此时我们就需要使用模板指令<code>:for</code>来完成需求：<br><figure class="highlight html"><figcaption><span>html</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- :for指令中只能使用两种特定语法 --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 第一种为“item in list”，item为list循环时的每一项值，它是一个局部变量，只能在:for属性所在的元素上及内部使用 --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 有时候我们需要获取遍历时的索引，此时你可以这样写“(item, i) in list”，这样就可以在:for属性所在的元素上及内部使用“i”变量了 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">:for</span>=<span class="string">"item in list"</span>&gt;</span>&#123;&#123; item &#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">new</span> am.Module ( &#123;</span></span><br><span class="line"><span class="javascript">        init : <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="javascript">                list: [ <span class="string">"apple"</span>, <span class="string">"orange"</span>, <span class="string">"grape"</span> ]</span></span><br><span class="line"><span class="undefined">            &#125;;</span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="javascript">        mounted : <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">            <span class="comment">// 我们可以调用数组的相关变异函数，在模板中绑定了此数组的地方也将作出相应更新，如下</span></span></span><br><span class="line"><span class="javascript">            <span class="keyword">this</span>.state.list.push ( <span class="string">"peach"</span> );</span></span><br><span class="line"><span class="javascript">            <span class="comment">// 其他可用的变异函数还有push、pop、sort、shift、unshift、splice、reverse</span></span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125; );</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="在-lt-template-gt-上使用-for"><a href="#在-lt-template-gt-上使用-for" class="headerlink" title="# 在&lt;template&gt;上使用:for"></a># 在<code>&lt;template&gt;</code>上使用<code>:for</code></h3><p>你可以在<code>&lt;template&gt;</code>上使用<code>:for</code>来循环渲染多个dom元素：<br><figure class="highlight html"><figcaption><span>html</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">:for</span>=<span class="string">"i in names"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>list.firstName<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>list.lastName<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">new</span> am.Module ( &#123;</span></span><br><span class="line"><span class="javascript">        init : <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="undefined">                names: [</span></span><br><span class="line"><span class="javascript">                    &#123;<span class="attr">firstName</span>: <span class="string">"George"</span>, <span class="attr">lastName</span>: <span class="string">"Bush"</span>&#125;,</span></span><br><span class="line"><span class="javascript">                    &#123;<span class="attr">firstName</span>: <span class="string">"Jake"</span>, <span class="attr">lastName</span>: <span class="string">"Wood"</span>&#125;</span></span><br><span class="line"><span class="undefined">                ]</span></span><br><span class="line"><span class="undefined">            &#125;;</span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="undefined">    &#125; );</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>它将被渲染为：<br><figure class="highlight html"><figcaption><span>html</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &lt;template&gt;标签自动被去除 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>George<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>Bush<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>Jake<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>Wood<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="使用-for指令遍历字符串"><a href="#使用-for指令遍历字符串" class="headerlink" title="# 使用:for指令遍历字符串"></a># 使用<code>:for</code>指令遍历字符串</h3><p>当<code>:for</code>指令遍历字符串时，item值为字符串每个字符：<br><figure class="highlight html"><figcaption><span>html</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">strong</span>&gt;</span>Amaple由<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">:for</span>=<span class="string">"char in 'Amaple'"</span>&gt;</span>[&#123;&#123; char &#125;&#125;]<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">strong</span>&gt;</span>组成<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 渲染后的文字为：Amaple由[A][m][a][p][l][e]组成 --&gt;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="使用-for指令遍历数字"><a href="#使用-for指令遍历数字" class="headerlink" title="# 使用:for指令遍历数字"></a># 使用<code>:for</code>指令遍历数字</h3><p>当<code>:for</code>指令遍历数字时，item值为从0开始累加的索引数字：<br><figure class="highlight html"><figcaption><span>html</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">strong</span>&gt;</span>小于5的非负数有<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">:for</span>=<span class="string">"num in 5"</span>&gt;</span>[&#123;% raw %&#125;&#123;&#123;<span class="tag">&lt;<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span>&gt;</span>num &#125;&#125;&#123;% endraw %&#125;]<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 渲染后的文字为：小于5的非负数有[0][1][2][3][4] --&gt;</span></span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>使用状态数组应该避免直接通过索引操作，如<code>this.state.list [ 0 ] = &quot;banana&quot;</code>将不会触发自动更新。</p>
</blockquote>
<h2 id="通过条件判断显示与隐藏元素"><a href="#通过条件判断显示与隐藏元素" class="headerlink" title="通过条件判断显示与隐藏元素"></a>通过条件判断显示与隐藏元素</h2><p>我们经常需要通过条件判断来确定应该显示哪一部分的内容，以简单的用户登录为例，当有用户信息时显示信息，没有时显示登录按钮，此时可以使用模板指令的<code>:if</code>、<code>:else-if</code>、<code>:else</code>，它与我们熟知的<code>if</code>、<code>else if</code>及<code>else</code>关键字的用法相同：</p>
<figure class="highlight html"><figcaption><span>html</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">:if</span>=<span class="string">"userInfo"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"&#123;&#123; userInfo.avatar &#125;&#125;"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; userInfo.username &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">:else</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"login.action"</span>&gt;</span>您还没有登录，点击登录<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">new</span> am.Module ( &#123;</span></span><br><span class="line"><span class="javascript">        init : <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="javascript">                userInfo : <span class="literal">null</span></span></span><br><span class="line"><span class="undefined">            &#125;;</span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="javascript">        mounted : <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">this</span>.state.userInfo = &#123; <span class="attr">username</span>: <span class="string">"Tom"</span>, <span class="attr">avatar</span>: <span class="string">"tom_101101.jpg"</span> &#125;;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125; );</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>当初始化时<code>module.state.userInfo=null</code>，它将被渲染为：</p>
<figure class="highlight html"><figcaption><span>html</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"login.action"</span>&gt;</span>您还没有登录，点击登录<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>当<code>mounted</code>钩子函数触发后<code>module.state.userInfo={ username: &quot;Tom&quot;, avatar: &quot;tom_101101.jpg&quot; }</code>，它将被渲染为：<br><figure class="highlight html"><figcaption><span>html</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"tom_101101.jpg"</span> /&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">span</span>&gt;</span>Tom<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="在-lt-template-gt-上使用条件判断"><a href="#在-lt-template-gt-上使用条件判断" class="headerlink" title="# 在&lt;template&gt;上使用条件判断"></a># 在<code>&lt;template&gt;</code>上使用条件判断</h3><p>它将<code>&lt;template&gt;</code>的子元素作为一个整体进行条件判断，并在渲染的时候去掉<code>&lt;template&gt;</code>父元素。</p>
<figure class="highlight html"><figcaption><span>html</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">:if</span>=<span class="string">"show === true"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>content1<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>content2<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">:else-if</span>=<span class="string">"show === false"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>content3<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>content4<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>content5<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">new</span> am.Module ( &#123;</span></span><br><span class="line"><span class="javascript">        init : <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="javascript">                show: <span class="literal">true</span></span></span><br><span class="line"><span class="undefined">            &#125;;</span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="undefined">    &#125; );</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>当<code>module.state.show=true</code>时将被渲染为：</p>
<figure class="highlight html"><figcaption><span>html</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>content1<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>content2<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>当module.state.show=false时将被渲染为：</p>
<figure class="highlight html"><figcaption><span>html</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>content3<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>content4<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>当module.state.show=1时将被渲染为：</p>
<figure class="highlight html"><figcaption><span>html</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>content5<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="for和-if在同一个元素上使用"><a href="#for和-if在同一个元素上使用" class="headerlink" title="# :for和:if在同一个元素上使用"></a># <code>:for</code>和<code>:if</code>在同一个元素上使用</h3><p><code>:for</code>指令的解析优先级高于<code>:if</code>，这意味着所有循环渲染的元素都会判断<code>:if</code>的条件。</p>
<figure class="highlight html"><figcaption><span>html</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">:for</span>=<span class="string">"item in list"</span> <span class="attr">:if</span>=<span class="string">"item !== 'apple'"</span>&gt;</span>&#123;&#123; item &#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">new</span> am.Module ( &#123;</span></span><br><span class="line"><span class="javascript">        init : <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="javascript">                list: [ <span class="string">"apple"</span>, <span class="string">"orange"</span>, <span class="string">"grape"</span> ]</span></span><br><span class="line"><span class="undefined">            &#125;;</span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="undefined">    &#125; );</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>它将被渲染为：<br><figure class="highlight html"><figcaption><span>html</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>orange<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>grape<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>带有<code>:else-if</code>或<code>:else</code>属性元素的上一个兄弟元素必须使用了<code>:if</code>或<code>:else-if</code>指令，且<code>:else</code>属性是没有值的</p>
</blockquote>
<h2 id="模块函数与事件绑定"><a href="#模块函数与事件绑定" class="headerlink" title="模块函数与事件绑定"></a>模块函数与事件绑定</h2><p>在状态数据对象上定义的函数叫做模块函数，我们在子模块主动向父模块传值时提到过它。除了传值的作用外，模块函数还可当做事件绑定函数来使用，如下面事件绑定的示例，在<code>&lt;button&gt;</code>上使用<code>:on</code>指令声明<code>click</code>事件并指定回调函数。<br><figure class="highlight html"><figcaption><span>html</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- :on指令的用法是在它的后面补充上事件名称，如:onclick、:onchange等 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 使用这个指令绑定事件共有三种形式 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- ①.直接指定一个模块函数作为事件回调函数 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">:onclick</span>=<span class="string">"clickHandler"</span>&gt;</span>BTN1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- ②.在指定一个模块函数为事件回调函数的同时传递参数到此模块函数内 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">:onclick</span>=<span class="string">"clickHandler ( 'a', 111 )"</span>&gt;</span>BTN2<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- ③.当你认为你的事件处理函数很简单，并且不会在其他地方重用时，那你也可以直接将JavaScript代码写到:on指令的值中 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">:onclick</span>=<span class="string">"var text = 'BTN2 has clicked!'; alert(text);"</span>&gt;</span>BTN3<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">new</span> am.Module ( &#123;</span></span><br><span class="line"><span class="javascript">        init : <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">                <span class="comment">// 需注意的是，作为事件绑定的模块函数的第一个参数永远为event对象，而在额外传入的参数在模块函数中第二个开始接收</span></span></span><br><span class="line"><span class="javascript">                <span class="comment">// 在第②种形式中传入了字符串"a"和数字111到模块函数中，模块函数在第二个开始接收，即str的值为"a"，num为111</span></span></span><br><span class="line"><span class="javascript">                clickHandler: <span class="function"><span class="keyword">function</span> (<span class="params"> event, str, num </span>) </span>&#123; ... &#125;</span></span><br><span class="line"><span class="undefined">            &#125;;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125; );</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>模块函数内的<code>this</code>指针指向当前模块的状态数据对象（即<code>module.state</code>对象），它也不可使用ES6的箭头函数（Arrow function），因为这样会导致函数内<code>this</code>指针指向不正确而出错。</p>
</blockquote>
<h2 id="计算属性"><a href="#计算属性" class="headerlink" title="计算属性"></a>计算属性</h2><p>假如项目的某个模块中定义了两个状态属性，分别为产品品牌brand、产品型号model，此时你需要在模板中输出品牌与型号的组合，此时你可能会这样写：<br><figure class="highlight html"><figcaption><span>html</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; brand &#125;&#125; &#123;&#123; model &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">new</span> am.Module ( &#123;</span></span><br><span class="line"><span class="javascript">        init : <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="javascript">                brand : <span class="string">"Samsung"</span>,</span></span><br><span class="line"><span class="javascript">                model : <span class="string">"Note8"</span></span></span><br><span class="line"><span class="undefined">            &#125;;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125; );</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>这没有任何问题，但当有多处都需输出同样信息时，使用多个差值表达式就显得有点麻烦，所以对于如需要多次拼接字符串或其他任何较为复杂处理的输出，应该使用计算属性来实现，像这样：<br><figure class="highlight html"><figcaption><span>html</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; productName &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">new</span> am.Module ( &#123;</span></span><br><span class="line"><span class="javascript">        init : <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="javascript">                brand: <span class="string">"Samsung"</span>,</span></span><br><span class="line"><span class="javascript">                model: <span class="string">"Note8"</span>,</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">                <span class="comment">// 在状态数据对象中指定computed属性，它的值为一个对象，此对象内的所有属性都将被转换为计算属性</span></span></span><br><span class="line"><span class="undefined">                computed: &#123;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">                    <span class="comment">// 这里定义了一个计算属性productName，它分别有get和set函数</span></span></span><br><span class="line"><span class="javascript">                    <span class="comment">// 框架在初始化计算属性时将会调用get函数获取并缓存此计算属性的值，而获取this.state.productName的值时都将会返回缓存的值</span></span></span><br><span class="line"><span class="javascript">                    <span class="comment">// 当为this.state.productName赋值时，则会调用此计算属性的set函数并接收一个新值</span></span></span><br><span class="line"><span class="javascript">                    <span class="comment">// 从该计算属性productName的get函数可看出，它依赖于状态数据brand和model，所以当brand或model的值更新时，此计算属性的缓存值也会更新</span></span></span><br><span class="line"><span class="undefined">                    productName: &#123;</span></span><br><span class="line"><span class="javascript">                        get: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                            <span class="keyword">return</span> <span class="keyword">this</span>.brand + <span class="string">" "</span> + <span class="keyword">this</span>.model;</span></span><br><span class="line"><span class="undefined">                        &#125;,</span></span><br><span class="line"><span class="javascript">                        set: <span class="function"><span class="keyword">function</span> (<span class="params"> val </span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                            <span class="keyword">var</span> split = val.split ( <span class="string">" "</span> );</span></span><br><span class="line"><span class="javascript">                            <span class="keyword">this</span>.brand = split [ <span class="number">0</span> ];</span></span><br><span class="line"><span class="javascript">                            <span class="keyword">this</span>.model = split [ <span class="number">1</span> ];</span></span><br><span class="line"><span class="undefined">                        &#125;</span></span><br><span class="line"><span class="undefined">                    &#125;</span></span><br><span class="line"><span class="undefined">                    </span></span><br><span class="line"><span class="javascript">                    <span class="comment">// 一个计算属性可以只设置get函数，你可以像上面那样直接去掉set函数，也可以直接将此计算属性定义为一个函数作为get函数，像这样</span></span></span><br><span class="line"><span class="javascript">                    <span class="comment">// productName: function () &#123; return this.brand + " " + this.model; &#125;</span></span></span><br><span class="line"><span class="undefined">                &#125;</span></span><br><span class="line"><span class="undefined">            &#125;;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125; );</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h2 id="表单的双向绑定"><a href="#表单的双向绑定" class="headerlink" title="表单的双向绑定"></a>表单的双向绑定</h2><p>在表单元素上使用<code>:model</code>指令即可实现表单输入值与状态属性的双向绑定，如下：<br><figure class="highlight html"><figcaption><span>html</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 当此input输入框的value值改变时，状态属性username的值也将自动同步更新 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">:model</span>=<span class="string">"username"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">new</span> am.Module ( &#123;</span></span><br><span class="line"><span class="javascript">        init : <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="undefined">                </span></span><br><span class="line"><span class="javascript">                <span class="comment">// 当此状态属性的值改变时，上面的input输入框的value值也将同步更新</span></span></span><br><span class="line"><span class="javascript">                username: <span class="string">""</span></span></span><br><span class="line"><span class="undefined">            &#125;;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125; );</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>可使用model指令的表单元素有type为任何值的<code>input</code>、<code>textarea</code>和<code>select</code>。</p>
</blockquote>
<h3 id="model指令在checkbox上使用"><a href="#model指令在checkbox上使用" class="headerlink" title="# :model指令在checkbox上使用"></a># <code>:model</code>指令在<code>checkbox</code>上使用</h3><p><code>checkbox</code>绑定的状态属性值必须为<code>Array</code>类型，且当多个<code>checkbox</code>绑定同一个状态属性时，被选中<code>checkbox</code>的值将会保存在此数组中。</p>
<h3 id="model指令在radio上使用"><a href="#model指令在radio上使用" class="headerlink" title="# :model指令在radio上使用"></a># <code>:model</code>指令在<code>radio</code>上使用</h3><p><code>radio</code>元素没有设置<code>name</code>属性时，自动设置绑定的状态属性名为<code>name</code>属性。</p>
<blockquote>
<p>以上所有指令为动态指令，接下来的是静态指令</p>
</blockquote>
<h2 id="设置当前页面显示的标题"><a href="#设置当前页面显示的标题" class="headerlink" title="设置当前页面显示的标题"></a>设置当前页面显示的标题</h2><p>当url跳转更新模块时，我们希望标题随模块改变，此时我们可使用<code>:title</code>指令来设置标题，它只能用于一个模块的<code>&lt;module&gt;</code>元素上，像这样：<br><figure class="highlight html"><figcaption><span>html</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">module</span> <span class="attr">:title</span>=<span class="string">"hello amaplejs"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span>&gt;</span>...<span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined">...</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined">...</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>当然很多时候一个页面将同时加载多个不同层级的模块，此时框架将会从上到下、从外到内的顺序解析并更新模块，当以这样的顺序解析时将会获取第一个<code>:title</code>不为空的标题作为更新标题，而会自动忽略后面模块所定义的标题，所以建议标题应该在最外层的主模块中定义。</p>
</blockquote>
<h2 id="引用元素"><a href="#引用元素" class="headerlink" title="引用元素"></a>引用元素</h2><p>有时候必须操作dom元素如聚焦<code>input</code>元素，我们必须获取此<code>input</code>元素的对象并调用<code>input.focus</code>函数，这时可以在此<code>input</code>元素上使用<code>:ref</code>指令定义一个引用，然后调用<code>am.Module</code>对象的成员函数<code>refs( refName )</code>获取被引用的dom元素：</p>
<figure class="highlight html"><figcaption><span>html</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">:ref</span>=<span class="string">"ref_dom"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">new</span> am.Module ( &#123;</span></span><br><span class="line"><span class="javascript">        init : <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; ... &#125;,</span></span><br><span class="line"><span class="javascript">        mounted : <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">            <span class="comment">// 这样就获取到了模板中的input元素并聚焦</span></span></span><br><span class="line"><span class="javascript">            <span class="keyword">this</span>.refs ( <span class="string">"ref_dom"</span> ).focus ();</span></span><br><span class="line"><span class="javascript">            <span class="comment">// refs函数不能在init生命周期函数中使用，因为init函数被调用时还未解析模板</span></span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125; );</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>当多个元素的<code>:ref</code>值设置同一个引用名时，使用<code>refs</code>函数获取该引用名的dom元素时将会返回一个包含所有该引用名的元素数组。</p>
</blockquote>
</div>
		<div id="page-nav">
			<a class="title-color nav next" href="{{ next.path }}" :if="next.title">
				<img src="/images/arrow.png">
				<span class="title-color">{{ next.title }}</span>
			</a>
			<a class="nav prev" href="{{ prev.path }}" :if="prev.title">
				<span class="title-color">{{ prev.title }}</span>
				<img src="/images/arrow.png">
			</a>
		</div>
	</template>
	<script>
		function scrollAnchor ( anchor, scrollTo ) {
			var anchorElem = document.querySelector ( "#" + window.decodeURI ( anchor ) );
			if ( anchorElem ) {
				scrollTo ( anchorElem.offsetTop - 10 );
			}
		}

		new am.Module ( {
			init: function ( menu, checkPost ) {
				var list = [{"tag":"模板指令与状态数据(state)","children":[{"tag":"指令类型","children":[]},{"tag":"使用插值表达式输出文本","children":[{"tag":"# 插值表达式在style与class属性的特殊表现","children":[]}]},{"tag":"循环渲染输出dom元素","children":[{"tag":"# 在&lt;template&gt;上使用:for","children":[]},{"tag":"# 使用:for指令遍历字符串","children":[]},{"tag":"# 使用:for指令遍历数字","children":[]}]},{"tag":"通过条件判断显示与隐藏元素","children":[{"tag":"# 在&lt;template&gt;上使用条件判断","children":[]},{"tag":"# :for和:if在同一个元素上使用","children":[]}]},{"tag":"模块函数与事件绑定","children":[]},{"tag":"计算属性","children":[]},{"tag":"表单的双向绑定","children":[{"tag":"# :model指令在checkbox上使用","children":[]},{"tag":"# :model指令在radio上使用","children":[]}]},{"tag":"设置当前页面显示的标题","children":[]},{"tag":"引用元素","children":[]}]}],
					posts = [{"title":"开始","path":"first-step","index":1},{"title":"启动路由","path":"start-router","index":2},{"title":"模块","path":"module","index":3},{"title":"模板指令与状态数据(state)","path":"directive-and-state","index":4,"current":true},{"title":"组件","path":"component","index":5},{"title":"插件","path":"plugin","index":6},{"title":"路由配置","path":"config-router","index":7}];

				menu.state.list = list.length > 0 ? list : [ { children: [] } ];
				menu.state.posts = posts;
				menu.state.categoryName = "基础";

				return {
					prev: checkPost ( {
						title: "组件",
						path: "component"
					}, posts ),
					next: checkPost ( {
						title: "模块",
						path: "module"
					}, posts )
				};
			},
			mounted: function ( scrollTo ) {
				scrollAnchor ( this.get.target, scrollTo );
			},
			queryUpdated: function ( scrollTo ) {
				scrollAnchor ( this.get.target, scrollTo );
			}
		} );
	</script>

	<style scoped>
		#page-nav {
			margin-top: 60px;
		}
		.nav {
			font-size: 16px;
			border: none;
		}
		.nav:hover {
			border: none;
		}
		.nav img {
			width: 18px;
			margin: 0 5px;
			vertical-align: middle;
		}
		.prev {
			float: right;
		}
		.next {
			float: left;
		}
		.next img {
			transform: rotate(180deg);
			-ms-transform: rotate(180deg);
			-moz-transform: rotate(180deg);
			-webkit-transform: rotate(180deg);;
			-o-transform: rotate(180deg);
		}
	</style>
</module>